<!DOCTYPE html>
<html lang="en">

<head>
    <!-- jQuery file -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <!-- reset css file -->
    <!-- <link rel="stylesheet" href="assets/css/reset.css"> -->
    <!-- bootstrap link -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
    <!-- css style file -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <title>survey</title>
</head>

<body>

    <div class="container justify-content-center">
        <div class="row">
            <div class="col-2"></div>
            <div class="jumbotron col-8">
                    <h1 class="main-header text-center">Please answer the questions below!</h1>
        
                <form class="">
                    <div class="form-group">
                        <h2>Name</h2>
                        <input type="text" id="name-input" class="form-control questions"
                            placeholder="Please type your name">
                        <h2>Photo</h2>
                        <input id="photo-input" class="form-control questions" type="text"
                            placeholder="URL only please">
                    </div>
                    <br>
                    <hr>
                    <div>
                        <div id="first-question-div" class="form-group">
                            <p>1. How hot do you like your pizza? (1 being cold and 5 being super hot)</p>
                            <select name="" class="questions form-control" id="first-question">
                                <option aria-placeholder="select">Select a number</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </div>
                        <hr>
                        <div id="second-question-div" class="form-group">
                            <p>2. how many slices can you eat?</p>
                            <select name="" class="questions form-control" id="second-question">
                                <option aria-placeholder="select">Select a number</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </div>
                        <hr>

                        <div id="third-question-div" class="form-group">
                            <p>3. How often do you eat pizza? (1 being monthly and 5 being daily)</p>
                            <select name="" class="questions form-control" id="third-question">
                                <option aria-placeholder="select">Select a number</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </div>
                        <hr>

                        <div id="fourth-question-div" class="form-group">
                            <p>4. Do you like cheese pizza? (1 being not so much and 5 being you love it)</p>
                            <select name="" class="questions form-control" id="fourth-question">
                                <option aria-placeholder="select">Select a number</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </div>
                        <hr>

                        <div id="fifth-question-div" class="form-group">
                            <p>5. Do you like pineapple on your pizza? (1 being not so much and 5 being you love it)</p>
                            <select name="" class="questions form-control" id="fifth-question">
                                <option aria-placeholder="select">Select a number</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </div>
                        <hr>

                        <div id="sixth-question-div" class="form-group">
                            <p>6. Do you like hot peppers on your pizza? (1 being not so much and 5 being you love it)
                            </p>
                            <select name="" class="questions form-control" id="sixth-question">
                                <option aria-placeholder="select">Select a number</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </div>

                    </div>
                    <br>
                    <hr>
                    <div class="text-center"> 
                    <button id="submit-data" class="btn btn-primary text-center" data-target="#my-modal"
                        data-toggle="modal">Submit</button>
                        </div>
                    <br>
                    <hr>
                    <p class="text-center">Developed by William Navas 2019</p>
                    <p class="text-center"><a class="link" href="/api/friendList">API Friend List Link</a></p>
                </form>
            </div>
            <div class="col-2"></div>

        </div>
    </div>

    <div class="modal fade" id="my-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header" id="my-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" id="modal-photo">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal" onclick="reload()">Close</button>
                </div>

            </div>
        </div>

    </div>
</body>


<script>


    //This function creates current object and send it to API with POST method
    $("#submit-data").on("click", function (event) {

        event.preventDefault();
        // To validate inputs //
        function validateForm() {
            var isValid = true;
            $(".questions").each(function () {
                if ($(this).val() === "") {
                    isValid = false;
                }
            });
            return isValid;
        }
        // If validate true run function // 
        if (validateForm()) {
            // Getting user values from inputs // 
            var value1 = $("#first-question").val().trim();
            var value2 = $("#second-question").val().trim();
            var value3 = $("#third-question").val().trim();
            var value4 = $("#fourth-question").val().trim();
            var value5 = $("#fifth-question").val().trim();
            var value6 = $("#sixth-question").val().trim();
            //Creating the object to be sent to API //
            friend = {
                name: $("#name-input").val().trim(),
                photo: $("#photo-input").val().trim(),
                answers: [Number(value1), Number(value2), Number(value3), Number(value4), Number(value5), Number(value6)],
                score: [],
                number: []
            }

            // POST method //
            $.post("/api/friendList", friend, function (data) {
                console.log("this is from API " + JSON.stringify(data));
            // To Clear the modal so we can append new values//
                $("#my-header").empty();
                $("#modal-photo").empty();
            // Appending values for matching friend to modal //
                var myName = $("<h2>");
                myName.text(data.name + " is your match!");
                $("#my-header").append(myName);
                $("#modal-photo").append("<img style = 'width : 460px' src=' " + data.photo + "'/>")
            })
        }
        // If validation false we alert the user//
        else {
            alert("Please fill all entries!")
            reload();
        }
    })

    //this function is to post new object to API
    $("#post-it").on("click", function (event) {
        event.preventDefault();
        var value1 = $("#first-question").val().trim();
        var value2 = $("#second-question").val().trim();
        var value3 = $("#third-question").val().trim();
        var value4 = $("#fourth-question").val().trim();
        var value5 = $("#fifth-question").val().trim();
        var value6 = $("#sixth-question").val().trim();
        newValue = {
            name: $("#name-input").val().trim(),
            photo: $("#photo-input").val().trim(),
            answers: [Number(value1), Number(value2), Number(value3), Number(value4), Number(value5), Number(value6)],
            score: [],
            number: []
        }
    })


    // to reaload page //
    function reload() {
        location.reload();
    }

</script>

</html>